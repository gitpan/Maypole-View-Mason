<%args>
$request
@objects
$base
$config
$classmetadata
$search => undef
$pager => undef
</%args>

<& header, %ARGS &>

%if ($search) {
<h2> Search results </h2>
%} else {
<h2> Listing of all <% $classmetadata->{plural} %></h2>
%}

<& navbar, config        => $config,
           classmetadata => $classmetadata,
           base          => $base &>
<div class="search"> <& search_form, %ARGS &> </div>

<div class="list">
<table id="matrix" width="100%">
<tr>
%foreach my $col (@{$classmetadata->{columns}}) {
%next if ($col eq "id");
    <th>
<%perl>
    my $additional = "?order=" . $col;
    $additional .= "&page=" . $pager->{current_page} if $pager;
    $additional .= "&o2=desc";
    if ($col eq $request->{query}->{order} && $request->{query}->{o2} ne "desc") {
    </%perl>
     <& macros/link, table=> $classmetadata->{table},
              command=>"list", 
	      config=>$config,
              additional=>$additional, 
              label=>$classmetadata->{colnames}->{$col}
      &>
%   }
    </th>
%}
</tr>

%my $count;
%foreach my $item (@objects) {
%$count++;
    <tr <%($count %2 ? 'class="alternate"':'')%> >
    <&macros/display_line, %ARGS, item=>$item &>
    </tr>
%}
</table>
</div>

<& pager,  %ARGS &>
<& addnew, %ARGS &>
</div>

<& footer, %ARGS &>
